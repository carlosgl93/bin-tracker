var X=n=>{throw TypeError(n)};var q=(n,t,i)=>t.has(n)||X("Cannot "+i);var l=(n,t,i)=>(q(n,t,"read from private field"),i?i.call(n):t.get(n)),B=(n,t,i)=>t.has(n)?X("Cannot add the same private member more than once"):t instanceof WeakSet?t.add(n):t.set(n,i),R=(n,t,i,o)=>(q(n,t,"write to private field"),o?o.call(n,i):t.set(n,i),i),F=(n,t,i)=>(q(n,t,"access private method"),i);import{b,g as ue,h as ce,k as de,j as e,m as me,n as he,o as V,p as pe,q as be,P as z,H as Y}from"./deepmerge-BXAv7Nhj.js";import{T as v,a as ve,B as y,S as D,y as L}from"./App-BvifF5Ye.js";import{g as xe}from"./mutation-CjtGMKQT.js";import{S as fe,l as je,i as Z,n as ne,x as ge,b as ye,w as Ne}from"./Grow-qSqvhMRg.js";import{a as Ce,F as Pe,T as c,b as Se,c as ke}from"./productionRecords-CEKcTaLe.js";import{G as f,D as Ee}from"./Grid-DXtbnt6M.js";import"./index-CMPTEgVS.js";var O,M,x,T,W,H,J,re,Ie=(re=class extends fe{constructor(t,i){super();B(this,W);B(this,O);B(this,M);B(this,x);B(this,T);R(this,O,t),this.setOptions(i),this.bindMethods(),F(this,W,H).call(this)}bindMethods(){this.mutate=this.mutate.bind(this),this.reset=this.reset.bind(this)}setOptions(t){var o;const i=this.options;this.options=l(this,O).defaultMutationOptions(t),je(this.options,i)||l(this,O).getMutationCache().notify({type:"observerOptionsUpdated",mutation:l(this,x),observer:this}),i!=null&&i.mutationKey&&this.options.mutationKey&&Z(i.mutationKey)!==Z(this.options.mutationKey)?this.reset():((o=l(this,x))==null?void 0:o.state.status)==="pending"&&l(this,x).setOptions(this.options)}onUnsubscribe(){var t;this.hasListeners()||(t=l(this,x))==null||t.removeObserver(this)}onMutationUpdate(t){F(this,W,H).call(this),F(this,W,J).call(this,t)}getCurrentResult(){return l(this,M)}reset(){var t;(t=l(this,x))==null||t.removeObserver(this),R(this,x,void 0),F(this,W,H).call(this),F(this,W,J).call(this)}mutate(t,i){var o;return R(this,T,i),(o=l(this,x))==null||o.removeObserver(this),R(this,x,l(this,O).getMutationCache().build(l(this,O),this.options)),l(this,x).addObserver(this),l(this,x).execute(t)}},O=new WeakMap,M=new WeakMap,x=new WeakMap,T=new WeakMap,W=new WeakSet,H=function(){var i;const t=((i=l(this,x))==null?void 0:i.state)??xe();R(this,M,{...t,isPending:t.status==="pending",isSuccess:t.status==="success",isError:t.status==="error",isIdle:t.status==="idle",mutate:this.mutate,reset:this.reset})},J=function(t){ne.batch(()=>{var i,o,m,j,g,h,w,N;if(l(this,T)&&this.hasListeners()){const C=l(this,M).variables,S=l(this,M).context;(t==null?void 0:t.type)==="success"?((o=(i=l(this,T)).onSuccess)==null||o.call(i,t.data,C,S),(j=(m=l(this,T)).onSettled)==null||j.call(m,t.data,null,C,S)):(t==null?void 0:t.type)==="error"&&((h=(g=l(this,T)).onError)==null||h.call(g,t.error,C,S),(N=(w=l(this,T)).onSettled)==null||N.call(w,void 0,t.error,C,S))}this.listeners.forEach(C=>{C(l(this,M))})})},re);function Te(n,t){const i=ge(),[o]=b.useState(()=>new Ie(i,n));b.useEffect(()=>{o.setOptions(n)},[o,n]);const m=b.useSyncExternalStore(b.useCallback(g=>o.subscribe(ne.batchCalls(g)),[o]),()=>o.getCurrentResult(),()=>o.getCurrentResult()),j=b.useCallback((g,h)=>{o.mutate(g,h).catch(ye)},[o]);if(m.error&&Ne(o.options.throwOnError,[m.error]))throw m.error;return{...m,mutate:j,mutateAsync:m.mutate}}function We(n){return ce("MuiInputAdornment",n)}const ee=ue("MuiInputAdornment",["root","filled","standard","outlined","positionStart","positionEnd","disablePointerEvents","hiddenLabel","sizeSmall"]);var te;const ze=(n,t)=>{const{ownerState:i}=n;return[t.root,t[`position${V(i.position)}`],i.disablePointerEvents===!0&&t.disablePointerEvents,t[i.variant]]},Oe=n=>{const{classes:t,disablePointerEvents:i,hiddenLabel:o,position:m,size:j,variant:g}=n,h={root:["root",i&&"disablePointerEvents",m&&`position${V(m)}`,g,o&&"hiddenLabel",j&&`size${V(j)}`]};return pe(h,We,t)},Me=me("div",{name:"MuiInputAdornment",slot:"Root",overridesResolver:ze})(be(({theme:n})=>({display:"flex",maxHeight:"2em",alignItems:"center",whiteSpace:"nowrap",color:(n.vars||n).palette.action.active,variants:[{props:{variant:"filled"},style:{[`&.${ee.positionStart}&:not(.${ee.hiddenLabel})`]:{marginTop:16}}},{props:{position:"start"},style:{marginRight:8}},{props:{position:"end"},style:{marginLeft:8}},{props:{disablePointerEvents:!0},style:{pointerEvents:"none"}}]}))),we=b.forwardRef(function(t,i){const o=de({props:t,name:"MuiInputAdornment"}),{children:m,className:j,component:g="div",disablePointerEvents:h=!1,disableTypography:w=!1,position:N,variant:C,...S}=o,k=Ce()||{};let A=C;C&&k.variant,k&&!A&&(A=k.variant);const p={...o,hiddenLabel:k.hiddenLabel,size:k.size,disablePointerEvents:h,position:N,variant:A},U=Oe(p);return e.jsx(Pe.Provider,{value:null,children:e.jsx(Me,{as:g,ownerState:p,className:he(U.root,j),ref:i,...S,children:typeof m=="string"&&!w?e.jsx(v,{color:"textSecondary",children:m}):e.jsxs(b.Fragment,{children:[N==="start"?te||(te=e.jsx("span",{className:"notranslate","aria-hidden":!0,children:"​"})):null,m]})})})}),se=[{label:"Lunes",key:"lunes"},{label:"Martes",key:"martes"},{label:"Miércoles",key:"miercoles"},{label:"Jueves",key:"jueves"},{label:"Viernes",key:"viernes"}],ae=["09:00-10:00","10:00-11:00","11:00-12:00","12:00-13:00","13:00-14:00","14:00-15:00","15:00-16:00","16:00-17:00","17:00-18:00","18:00-19:00"],ie=[{label:"Inicio",key:"inicio"},{label:"Chechito",key:"chechito"},{label:"Don Luis",key:"donluis"},{label:"Otros",key:"otros"}];function Ke(){const n=ve(),[t,i]=b.useState(()=>new Date().toISOString().split("T")[0]),[o,m]=b.useState("11:30"),[j,g]=b.useState("19:00"),[h,w]=b.useState([{porcentaje:"",valor:""},{porcentaje:"",valor:""},{porcentaje:"",valor:""},{porcentaje:"",valor:""},{porcentaje:"",valor:""}]),[N,C]=b.useState(Array(10).fill("")),S=N.reduce((a,s)=>a+(s===""?0:Number(s)),0),[k,A]=b.useState(0),[p,U]=b.useState({inicial:"",usados:""}),[u,K]=b.useState({inicial:"",usadas:"",malas:""}),[E,Q]=b.useState({inicio:"",chechito:"",donluis:"",otros:"",malos:""}),[I,$]=b.useState({1:"",2:"",3:""}),G=["inicio","chechito","donluis","otros","malos"].reduce((a,s)=>a+(E[s]===""?0:Number(E[s])),0),_=G-k-Number(E.malos),oe=Te({mutationFn:async a=>{await ke(a.date,a)},onSuccess:()=>{L.success("Registro de producción guardado exitosamente"),n("/",{state:{createdDate:t}})},onError:a=>{if(a instanceof Se){if(a.code==="permission-denied"){L.error("No tienes permisos para guardar registros de producción");return}if(a.code==="unavailable"){L.error("El servicio de Firebase no está disponible. Inténtalo más tarde.");return}if(a.code==="not-found"){L.error("El registro de producción no fue encontrado. Verifica la fecha.");return}if(a.code==="invalid-argument"){L.error("Los datos proporcionados son inválidos. Verifica los campos.");return}}L.error(`Error al guardar el registro: ${a instanceof Error?a.message:"Desconocido"}`)}}),le=a=>{a.preventDefault();const s={date:t,startTime:o,endTime:j,gasControl:se.map((r,d)=>({day:r.label,percentage:h[d].porcentaje===""?0:Number(h[d].porcentaje),value:h[d].valor===""?0:Number(h[d].valor)})),drumProductionByHour:ae.map((r,d)=>({range:r,count:N[d]===""?0:Number(N[d])})),drumStock:{initial:p.inicial===""?0:Number(p.inicial),used:p.usados===""?0:Number(p.usados),total:(p.inicial===""?0:Number(p.inicial))-(p.usados===""?0:Number(p.usados))},bagStock:{initial:u.inicial===""?0:Number(u.inicial),used:u.usadas===""?0:Number(u.usadas),damaged:u.malas===""?0:Number(u.malas),total:(u.inicial===""?0:Number(u.inicial))-(u.usadas===""?0:Number(u.usadas))-(u.malas===""?0:Number(u.malas))},binsStatus:ie.map(r=>({source:r.label,quantity:E[r.key]===""?0:Number(E[r.key])})),binsMalfunction:E.malos===""?0:Number(E.malos),totalExistence:G,totalProcessed:k,totalFinal:_,brix:{1:I[1]===""?0:Number(I[1]),2:I[2]===""?0:Number(I[2]),3:I[3]===""?0:Number(I[3])}};oe.mutate(s)};return e.jsx(y,{p:2,maxWidth:700,mx:"auto",children:e.jsxs("form",{onSubmit:le,autoComplete:"off",children:[e.jsx(v,{variant:"h5",gutterBottom:!0,children:"Nuevo Registro de Producción"}),e.jsx(v,{variant:"body1",gutterBottom:!0,children:"Ingresa los datos de producción para el día seleccionado"}),e.jsxs(z,{variant:"outlined",sx:{p:2,mb:2},children:[e.jsx(v,{variant:"subtitle2",mb:2,children:"Fecha del Registro"}),e.jsx(c,{type:"date",label:"Fecha",value:t,onChange:a=>i(a.target.value),fullWidth:!0,InputLabelProps:{shrink:!0}})]}),e.jsxs(z,{variant:"outlined",sx:{p:2,mb:2},children:[e.jsx(v,{variant:"subtitle2",children:"Horarios del Proceso"}),e.jsxs(f,{container:!0,spacing:2,mt:1,children:[e.jsx(f,{item:!0,xs:6,children:e.jsx(c,{label:"Hora de Inicio",type:"time",value:o,onChange:a=>m(a.target.value),fullWidth:!0,InputLabelProps:{shrink:!0}})}),e.jsx(f,{item:!0,xs:6,children:e.jsx(c,{label:"Hora de Término",type:"time",value:j,onChange:a=>g(a.target.value),fullWidth:!0,InputLabelProps:{shrink:!0}})})]})]}),e.jsxs(z,{variant:"outlined",sx:{p:2,mb:2},children:[e.jsx(v,{variant:"subtitle2",children:"Tambores y Horarios"}),e.jsx(v,{variant:"body2",mb:1,children:"Ingresa la cantidad por cada hora (09:00 - 19:00)"}),e.jsx(f,{container:!0,spacing:2,children:ae.map((a,s)=>e.jsxs(f,{item:!0,xs:6,md:2.4,children:[e.jsx(v,{children:a}),e.jsx(c,{type:"number",value:N[s],onChange:r=>{const d=[...N],P=r.target.value;(P===""||Number(P)>=0)&&(d[s]=P),C(d)},fullWidth:!0,size:"small",inputProps:{min:0}})]},a))}),e.jsxs(D,{direction:"row",justifyContent:"space-between",alignContent:"center",mt:2,children:[e.jsxs(v,{fontWeight:"bold",children:[S*240," Kgs"]}),e.jsxs(v,{fontWeight:"bold",children:["Total: ",S]})]})]}),e.jsxs(z,{variant:"outlined",sx:{p:2,mb:2},children:[e.jsx(v,{variant:"subtitle2",children:"Stock de Tambores"}),e.jsxs(D,{direction:"column",spacing:2,mt:2,children:[e.jsx(y,{children:e.jsx(c,{label:"Stock Inicial",type:"number",value:p.inicial,onChange:a=>{const s=a.target.value;(s===""||Number(s)>=0)&&U(r=>({...r,inicial:s}))},fullWidth:!0,size:"small",inputProps:{min:0}})}),e.jsx(y,{children:e.jsx(c,{label:"Tambores Usados",type:"number",value:p.usados,onChange:a=>{const s=a.target.value;(s===""||Number(s)>=0)&&U(r=>({...r,usados:s}))},fullWidth:!0,size:"small",inputProps:{min:0}})}),e.jsx(y,{children:e.jsx(c,{label:"Total",value:(p.inicial===""?0:Number(p.inicial))-(p.usados===""?0:Number(p.usados)),fullWidth:!0,size:"small",InputProps:{readOnly:!0}})})]})]}),e.jsxs(z,{variant:"outlined",sx:{p:2,mb:2},children:[e.jsx(v,{variant:"subtitle2",children:"Stock de Bolsas"}),e.jsxs(D,{direction:"column",spacing:2,mt:2,children:[e.jsx(y,{children:e.jsx(c,{label:"Stock Inicial",type:"number",value:u.inicial,onChange:a=>{const s=a.target.value;(s===""||Number(s)>=0)&&K(r=>({...r,inicial:s}))},fullWidth:!0,size:"small",inputProps:{min:0}})}),e.jsx(y,{children:e.jsx(c,{label:"Bolsas Usadas",type:"number",value:u.usadas,onChange:a=>{const s=a.target.value;(s===""||Number(s)>=0)&&K(r=>({...r,usadas:s}))},fullWidth:!0,size:"small",inputProps:{min:0}})}),e.jsx(y,{children:e.jsx(c,{label:"Bolsas Malas",type:"number",value:u.malas,onChange:a=>{const s=a.target.value;(s===""||Number(s)>=0)&&K(r=>({...r,malas:s}))},fullWidth:!0,size:"small",inputProps:{min:0}})}),e.jsx(y,{children:e.jsx(c,{label:"Total",value:(u.inicial===""?0:Number(u.inicial))-(u.usadas===""?0:Number(u.usadas))-(u.malas===""?0:Number(u.malas)),fullWidth:!0,size:"small",InputProps:{readOnly:!0}})})]})]}),e.jsxs(z,{variant:"outlined",sx:{p:2,mb:2},children:[e.jsx(v,{variant:"subtitle2",children:"Estado de Bins"}),e.jsxs(f,{container:!0,spacing:2,mt:2,children:[ie.map(a=>e.jsx(f,{item:!0,xs:6,md:2.4,children:e.jsx(c,{label:a.label,type:"number",value:E[a.key],onChange:s=>{const r=s.target.value;(r===""||Number(r)>=0)&&Q(d=>({...d,[a.key]:r}))},fullWidth:!0,size:"small",inputProps:{min:0}})},a.key)),e.jsx(f,{item:!0,xs:6,md:2.4,children:e.jsx(c,{label:"Bins Malos",type:"number",value:E.malos,onChange:a=>{const s=a.target.value;(s===""||Number(s)>=0)&&Q(r=>({...r,malos:s}))},fullWidth:!0,size:"small",inputProps:{min:0}})})]}),e.jsx(Ee,{sx:{my:2}}),e.jsxs(D,{direction:"column",spacing:2,mt:2,children:[e.jsx(f,{item:!0,xs:4,children:e.jsx(c,{type:"number",label:"Total Existencia",value:G,fullWidth:!0,size:"small",InputProps:{readOnly:!0}})}),e.jsx(f,{item:!0,xs:4,children:e.jsx(c,{label:"Total Procesados",value:k,fullWidth:!0,size:"small",onChange:a=>{const s=a.target.value;(s===""||Number(s)>=0)&&A(Number(s))}})}),e.jsx(f,{item:!0,xs:4,children:e.jsx(c,{label:"Total Final Proceso",value:_,fullWidth:!0,size:"small",InputProps:{readOnly:!0}})})]})]}),e.jsxs(z,{variant:"outlined",sx:{p:2,mb:2},children:[e.jsx(v,{variant:"subtitle2",children:"Brixs"}),e.jsxs(D,{direction:"column",spacing:2,mt:2,children:[e.jsx(y,{children:e.jsx(c,{label:"1",type:"number",value:I[1],onChange:a=>{const s=a.target.value;(s===""||Number(s)>=0)&&$(r=>({...r,1:s}))},fullWidth:!0,size:"small",inputProps:{min:0}})}),e.jsx(y,{children:e.jsx(c,{label:"2",type:"number",value:I[2],onChange:a=>{const s=a.target.value;(s===""||Number(s)>=0)&&$(r=>({...r,2:s}))},fullWidth:!0,size:"small",inputProps:{min:0}})}),e.jsx(y,{children:e.jsx(c,{label:"3",type:"number",value:I[3],onChange:a=>{const s=a.target.value;(s===""||Number(s)>=0)&&$(r=>({...r,3:s}))},fullWidth:!0,size:"small",inputProps:{min:0}})})]})]}),e.jsxs(z,{variant:"outlined",sx:{p:2,mb:2},children:[e.jsx(v,{variant:"subtitle2",children:"Control de Gas Diario"}),e.jsx(f,{container:!0,spacing:2,mt:1,children:se.map((a,s)=>e.jsxs(f,{item:!0,xs:12,md:2.4,children:[e.jsx(v,{fontWeight:"bold",children:a.label}),e.jsx(c,{label:"Porcentaje",type:"number",value:h[s].porcentaje,onChange:r=>{const d=[...h],P=r.target.value;(P===""||Number(P)>=0)&&(d[s].porcentaje=P),w(d)},fullWidth:!0,InputProps:{endAdornment:e.jsx(we,{position:"end",children:"%"}),inputProps:{min:0,step:"any"}},size:"small",sx:{mb:1},placeholder:""}),e.jsx(c,{label:"Valor",type:"number",value:h[s].valor,onChange:r=>{const d=[...h],P=r.target.value;(P===""||Number(P)>=0)&&(d[s].valor=P),w(d)},fullWidth:!0,size:"small",inputProps:{min:0,step:"any"}})]},a.key))})]}),e.jsxs(y,{display:"flex",justifyContent:"space-between",mt:3,children:[e.jsx(Y,{variant:"outlined",color:"secondary",href:"/daily",children:"Cancelar"}),e.jsx(Y,{variant:"contained",color:"primary",type:"submit",children:"Guardar Registro"})]})]})})}export{Ke as default};
